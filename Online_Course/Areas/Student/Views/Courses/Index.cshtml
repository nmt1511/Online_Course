@model Online_Course.ViewModels.StudentCourseIndexViewModel
@{
    ViewData["Title"] = "Danh sách khóa học";
    Layout = "~/Views/Shared/_StudentLayout.cshtml";
}

<div class="flex flex-col grow">
    <!-- Hero Section -->
    <div class="w-full bg-surface-light dark:bg-background-dark border-b border-border-light dark:border-border-dark">
        <div class="flex flex-col max-w-[1280px] mx-auto w-full">
            <div class="flex flex-col-reverse gap-6 px-4 py-8 md:py-12 lg:flex-row lg:items-center">
                <div class="flex flex-col gap-6 flex-1 lg:pr-8">
                    <div class="flex flex-col gap-3 text-left">
                        <h1 class="text-slate-900 dark:text-white text-3xl md:text-5xl font-black leading-tight tracking-[-0.033em]">
                            Nâng cao kiến thức<br/><span class="text-primary">mỗi ngày</span>
                        </h1>
                        <h2 class="text-slate-600 dark:text-text-secondary text-base md:text-lg font-normal leading-relaxed max-w-xl">
                            Khám phá hàng ngàn khóa học trực tuyến từ các chuyên gia hàng đầu. Học mọi lúc, mọi nơi trên nền tảng EduTech.
                        </h2>
                    </div>
                    <div class="flex flex-wrap gap-3">
                        <a href="#courses" class="flex cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 md:h-12 px-6 bg-primary hover:bg-blue-600 text-white text-base font-bold leading-normal transition-colors shadow-lg shadow-blue-500/20">
                            <span class="truncate">Khám phá ngay</span>
                        </a>
                    </div>
                </div>
                <div class="w-full lg:w-1/2 flex justify-center lg:justify-end">
                    <div class="w-full max-w-[600px] aspect-video bg-center bg-no-repeat bg-cover rounded-xl shadow-2xl" 
                         style="background-image: url('https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=600&h=400&fit=crop');"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Container -->
    <div id="courses" class="flex flex-1 justify-center py-8 px-4 md:px-10 bg-background-light dark:bg-background-dark">
        <div class="flex flex-col max-w-[1280px] w-full flex-1 gap-6">
            <!-- Heading -->
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                <div class="flex flex-col gap-1">
                    <h2 class="text-slate-900 dark:text-white text-[28px] md:text-[32px] font-bold leading-tight">Danh sách khóa học</h2>
                    <p class="text-slate-500 dark:text-text-secondary text-sm md:text-base font-normal">Tìm kiếm và đăng ký các khóa học phù hợp với mục tiêu của bạn</p>
                </div>
            </div>

            <!-- Filters (Category Chips) -->
            <div class="flex flex-wrap gap-3 pb-2 border-b border-border-light dark:border-border-dark">
                <a asp-action="Index" asp-route-categoryId="" 
                   class="flex h-9 items-center justify-center gap-x-2 rounded-full px-5 transition-colors @(!Model.SelectedCategoryId.HasValue ? "bg-primary text-white" : "bg-slate-200 dark:bg-surface-dark hover:bg-slate-300 dark:hover:bg-[#2a3441] text-slate-700 dark:text-text-secondary border border-transparent dark:border-border-dark")">
                    <span class="text-sm font-medium leading-normal">Tất cả</span>
                </a>
                @foreach (var category in Model.Categories)
                {
                    <a asp-action="Index" asp-route-categoryId="@category.CategoryId"
                       class="flex h-9 items-center justify-center gap-x-2 rounded-full px-5 transition-colors group @(Model.SelectedCategoryId == category.CategoryId ? "bg-primary text-white" : "bg-slate-200 dark:bg-surface-dark hover:bg-slate-300 dark:hover:bg-[#2a3441] text-slate-700 dark:text-text-secondary border border-transparent dark:border-border-dark")">
                        <span class="text-sm font-medium leading-normal @(Model.SelectedCategoryId != category.CategoryId ? "group-hover:text-slate-900 dark:group-hover:text-white" : "")">@category.Name</span>
                    </a>
                }
            </div>

            <!-- Course Grid -->
            @if (Model.Courses.Any())
            {
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    @foreach (var course in Model.Courses)
                    {
                        <a asp-action="Details" asp-route-id="@course.CourseId" class="flex flex-col bg-white dark:bg-surface-dark rounded-xl overflow-hidden shadow-sm hover:shadow-xl transition-all duration-300 border border-border-light dark:border-border-dark group h-full">
                            <div class="relative w-full aspect-video overflow-hidden">
                                @if (!string.IsNullOrEmpty(course.ThumbnailUrl))
                                {
                                    <div class="w-full h-full bg-center bg-no-repeat bg-cover group-hover:scale-105 transition-transform duration-500" 
                                         style="background-image: url('@course.ThumbnailUrl');"></div>
                                }
                                else
                                {
                                    <div class="w-full h-full bg-gradient-to-br from-primary/20 to-primary/40 flex items-center justify-center group-hover:scale-105 transition-transform duration-500">
                                        <span class="material-symbols-outlined text-6xl text-primary/60">school</span>
                                    </div>
                                }
                            </div>
                            <div class="flex flex-col p-5 flex-1">
                                @if (!string.IsNullOrEmpty(course.CategoryName))
                                {
                                    <div class="mb-2">
                                        <span class="inline-block px-2 py-1 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-xs font-semibold">@course.CategoryName</span>
                                    </div>
                                }
                                <h3 class="text-slate-900 dark:text-white text-lg font-bold leading-tight mb-2 line-clamp-2 group-hover:text-primary transition-colors">@course.Title</h3>
                                <p class="text-slate-500 dark:text-text-secondary text-sm font-normal leading-relaxed mb-4 line-clamp-2">@course.Description</p>
                                <div class="mt-auto flex flex-col gap-4">
                                    <div class="flex items-center justify-between text-xs text-slate-500 dark:text-text-secondary border-t border-border-light dark:border-border-dark pt-3">
                                        <div class="flex items-center gap-1">
                                            <span class="material-symbols-outlined text-[16px]">play_lesson</span>
                                            <span>@course.LessonCount bài học</span>
                                        </div>
                                        <div class="flex items-center gap-1">
                                            <span class="material-symbols-outlined text-[16px]">group</span>
                                            <span>@course.EnrollmentCount học viên</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2 text-xs text-slate-500 dark:text-text-secondary">
                                        <span class="material-symbols-outlined text-[16px]">person</span>
                                        <span>@course.InstructorName</span>
                                    </div>
                                </div>
                            </div>
                        </a>
                    }
                </div>
            }
            else
            {
                <div class="flex flex-col items-center justify-center py-16 text-center">
                    <span class="material-symbols-outlined text-6xl text-text-secondary mb-4">school</span>
                    <h3 class="text-xl font-bold text-white mb-2">Chưa có khóa học nào</h3>
                    <p class="text-text-secondary">
                        @if (Model.SelectedCategoryId.HasValue)
                        {
                            var selectedCat = Model.Categories.FirstOrDefault(c => c.CategoryId == Model.SelectedCategoryId);
                            <span>Không tìm thấy khóa học trong danh mục "@(selectedCat?.Name ?? "đã chọn")".</span>
                        }
                        else
                        {
                            <span>Các khóa học sẽ sớm được cập nhật.</span>
                        }
                    </p>
                </div>
            }
        </div>
    </div>
</div>
