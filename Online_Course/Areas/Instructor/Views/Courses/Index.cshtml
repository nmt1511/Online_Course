@model IEnumerable<Online_Course.ViewModels.InstructorCourseListViewModel>
@{
    ViewData["Title"] = "Khóa học của tôi";
    Layout = "~/Views/Shared/_InstructorLayout.cshtml";
}

<div class="flex flex-col gap-6">
    <!-- Page Header -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 pb-6 border-b border-gray-200 dark:border-slate-800">
        <div class="flex flex-col gap-2">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900 dark:text-white">Khóa học của tôi</h1>
            <p class="text-gray-500 dark:text-slate-400">Quản lý và chỉnh sửa các khóa học bạn đang giảng dạy.</p>
        </div>
        <a asp-action="Create" class="bg-primary hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg transition-colors flex items-center gap-2">
            <span class="material-symbols-outlined">add</span>
            Tạo khóa học mới
        </a>
    </div>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="bg-green-500/10 border border-green-500/20 text-green-600 dark:text-green-500 px-4 py-3 rounded-lg flex items-center gap-2">
            <span class="material-symbols-outlined">check_circle</span>
            @TempData["SuccessMessage"]
        </div>
    }

    <!-- Course Grid -->
    @if (!Model.Any())
    {
        <div class="bg-white dark:bg-surface-dark rounded-xl border border-gray-200 dark:border-slate-800 p-12 text-center">
            <span class="material-symbols-outlined text-gray-400 dark:text-slate-500 text-6xl mb-4">school</span>
            <h3 class="text-slate-900 dark:text-white text-xl font-bold mb-2">Chưa có khóa học</h3>
            <p class="text-gray-500 dark:text-slate-400 mb-4">Bạn chưa được phân công giảng dạy khóa học nào.</p>
        </div>
    }
    else
    {
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            @foreach (var course in Model)
            {
                <div class="bg-white dark:bg-surface-dark rounded-xl border border-gray-200 dark:border-slate-800 overflow-hidden group hover:border-primary/50 transition-colors relative">
                    <a asp-action="Details" asp-route-id="@course.CourseId" class="absolute inset-0 z-0"></a>
                    <div class="absolute top-3 left-3 z-10">
                        <span class="@course.TypeColor backdrop-blur-md text-white text-xs font-bold px-2 py-1 rounded">@course.TypeText</span>
                    </div>
                    <div class="absolute top-3 right-3 z-10">
                        <span class="@course.StatusColor backdrop-blur-md text-white text-xs font-bold px-2 py-1 rounded">@course.StatusText</span>
                    </div>
                    <div class="h-40 bg-cover bg-center bg-gray-200 dark:bg-slate-700" style="background-image: url('@(string.IsNullOrEmpty(course.ThumbnailUrl) ? "/images/default-course.png" : course.ThumbnailUrl)');"></div>
                    <div class="p-5">
                        <div class="flex items-center gap-2 text-xs font-semibold text-primary uppercase tracking-wider mb-2">
                            @if (!string.IsNullOrEmpty(course.CategoryName))
                            {
                                <span class="bg-primary/10 px-2 py-0.5 rounded">@course.CategoryName</span>
                            }
                        </div>
                        <h4 class="text-slate-900 dark:text-white font-bold text-lg mb-2 line-clamp-2">@course.Title</h4>
                        <p class="text-gray-500 dark:text-slate-400 text-sm mb-4 line-clamp-2">@course.Description</p>

                        <div class="flex items-center justify-between text-xs text-gray-500 dark:text-slate-500 mb-4">
                            <div class="flex items-center gap-1">
                                <span class="material-symbols-outlined text-[16px]">group</span>
                                @course.EnrollmentCount Học viên
                            </div>
                            <div class="flex items-center gap-1">
                                <span class="material-symbols-outlined text-[16px]">play_lesson</span>
                                @course.LessonCount Bài học
                            </div>
                            <div class="flex items-center gap-1">
                                <span class="material-symbols-outlined text-[16px] text-yellow-500">star</span>
                                @course.AverageRating.ToString("F1")
                            </div>
                        </div>

                        <div class="flex gap-2 relative z-10">
                            <a asp-action="Details" asp-route-id="@course.CourseId"
                               class="flex-1 bg-primary hover:bg-blue-600 text-white text-sm font-medium py-2.5 rounded-lg transition-colors flex items-center justify-center gap-2">
                                <span class="material-symbols-outlined text-[18px]">visibility</span>
                                Xem chi tiết
                            </a>
                            <a asp-action="Edit" asp-route-id="@course.CourseId"
                               class="flex-1 bg-primary/10 hover:bg-primary hover:text-white text-primary text-sm font-medium py-2.5 rounded-lg transition-colors border border-primary/20 flex items-center justify-center gap-2">
                                <span class="material-symbols-outlined text-[18px]">edit</span>
                                Chỉnh sửa
                            </a>
                        </div>
                        <div class="flex gap-2 mt-2 relative z-10">
                            <a asp-area="Instructor" asp-controller="Lessons" asp-action="Index" asp-route-courseId="@course.CourseId"
                               class="flex-1 bg-gray-100 dark:bg-slate-800 hover:bg-gray-200 dark:hover:bg-slate-700 text-gray-700 dark:text-slate-300 text-sm font-medium py-2.5 rounded-lg transition-colors border border-gray-200 dark:border-slate-700 flex items-center justify-center gap-2">
                                <span class="material-symbols-outlined text-[18px]">menu_book</span>
                                Bài học
                            </a>
                            <form asp-action="Delete" asp-route-id="@course.CourseId" method="post" class="flex-1 delete-form">
                                @Html.AntiForgeryToken()
                                <button type="button" onclick="showConfirmDialog(this.closest('form'), 'Xóa khóa học', 'Bạn có chắc chắn muốn xóa khóa học này? Tất cả bài học, đăng ký và tiến độ học viên sẽ bị xóa vĩnh viễn.', 'Xóa khóa học', 'danger')" class="w-full bg-red-500/10 hover:bg-red-500 hover:text-white text-red-500 text-sm font-medium py-2.5 rounded-lg transition-colors border border-red-500/20 flex items-center justify-center gap-2">
                                    <span class="material-symbols-outlined text-[18px]">delete</span>
                                    Xóa
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>